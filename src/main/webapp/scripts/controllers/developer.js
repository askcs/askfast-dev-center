define(["controllers/controllers"],function(e){e.controller("developer",["$rootScope","$scope","AskFast","Store","Moment",function(e,t,n,r,i){r=r("data"),t.current="debugger",t.setSection=function(e){t.current=e},t._types=["Phone","SMS","Gtalk","Email","Twitter"],t.adapterTypes={broadsoft:{label:"Phone",ids:[]},xmpp:{label:"Gtalk",ids:[]},email:{label:"Email",ids:[]},twitter:{label:"Twitter",ids:[]},sms:{label:"SMS",ids:[]},other:{label:"Others",ids:[]}},t.channel={type:null,extension:null},t.candidates=[],t.channelTypeSelected=function(){var e=[];angular.forEach(t.extensions,function(n){t.channel.type==n.type&&e.push({id:n.id,value:n.value})}),t.candidates=e},t.query={severity:"ALL",ddr:!1,limit:100},t.Log={data:null,list:function(){n.caller("log",{limit:t.query.limit}).then(function(e){function n(e){return e[0]=="{"&&e[e.length-1]=="}"?angular.fromJson(e):e}var r={DDR:[],INFO:[],SEVERE:[]};angular.forEach(e,function(e){t.adapterTypes.broadsoft.ids.indexOf(e.adapterID)>=0,r[e.level].push(e)}),this.data=r,this.filter()}.bind(this))},filter:function(){switch(t.query.severity){case"ALL":var e=[],n=this.data;t.query.ddr||delete n.DDR,angular.forEach(n,function(t){angular.forEach(t,function(t){e.push(t)})}),t.logs=e;break;default:t.logs=this.data[t.query.severity]}}},t.$watch("query.ddr",function(){t.Log.list()}),t.Log.list(),t.Adapter={list:function(e){t.adapterType="",n.caller("getAdapters").then(function(n){angular.forEach(n,function(e){t.adapterTypes[e.adapterType].ids.push(e.configId)}),r.save(t.adapterTypes,"adapterTypes"),t.extensions=n,e&&e.call()})},add:function(e){n.caller("createAdapter",{level:e.configId}).then(function(){this.list()}.bind(this))},query:function(e){n.caller("freeAdapters",{adapterType:e}).then(function(e){t.freeAdapters=e})},remove:function(e){n.caller("removeAdapter",{level:e.configId}).then(function(){this.list()}.bind(this))}},t.Adapter.list(),t.Dialog={list:function(e){n.caller("getDialog").then(function(n){t.dialogs=n,e&&e.call()})},add:function(e){n.caller("createDialog",null,{name:e.form.name,url:e.form.url}).then(function(){t.addingDialog=!1,this.list(function(){t.setSection("dialogs")})}.bind(this))},remove:function(e){n.caller("deleteDialog",{node:e.id}).then(function(){t.addingDialog=!1,this.list(function(){t.setSection("dialogs")})}.bind(this))},open:function(e){t.dialog=e}},t.Dialog.list()}])});